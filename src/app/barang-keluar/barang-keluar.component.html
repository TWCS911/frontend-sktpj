<div class="container">
  <h1>Barang Keluar</h1>

  <!-- Form untuk menambah Barang Keluar -->
  <form (ngSubmit)="tambahBarangKeluar()" #barangKeluarForm="ngForm">
    <div class="form-group">
      <label for="idBarang">Pilih Barang</label>
      <select
        id="idBarang"
        [(ngModel)]="newBarangKeluar.idBarang"
        name="idBarang"
        class="form-control"
        required
      >
        <option value="">-- Pilih Barang --</option>
        <option *ngFor="let barang of barangList" [value]="barang._id">
          {{ barang.nama }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="jumlah">Jumlah</label>
      <input
        type="number"
        id="jumlah"
        [(ngModel)]="newBarangKeluar.jumlah"
        name="jumlah"
        class="form-control"
        required
        min="1"
      />
    </div>

    <div class="form-group">
      <label for="penerima">Penerima</label>
      <input
        type="text"
        id="penerima"
        [(ngModel)]="newBarangKeluar.penerima"
        name="penerima"
        class="form-control"
        required
      />
    </div>

    <div class="form-group">
      <label for="keterangan">Keterangan</label>
      <textarea
        id="keterangan"
        [(ngModel)]="newBarangKeluar.keterangan"
        name="keterangan"
        class="form-control"
      ></textarea>
    </div>

    <div class="form-group">
      <label for="tanggalKeluar">Tanggal Keluar</label>
      <input
        type="date"
        id="tanggalKeluar"
        [(ngModel)]="newBarangKeluar.tanggalKeluar"
        name="tanggalKeluar"
        class="form-control"
      />
    </div>

    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="isLoading || !barangKeluarForm.form.valid"
    >
      {{ isLoading ? 'Loading...' : 'Tambah Barang Keluar' }}
    </button>
  </form>

  <hr />

  <!-- Daftar Barang Keluar -->
  <h2>Daftar Barang Keluar</h2>
  <div *ngIf="transaksiList.length === 0">
    <p>Tidak ada barang keluar yang tercatat.</p>
  </div>
  <table class="table table-bordered" *ngIf="transaksiList.length > 0">
    <thead>
      <tr>
        <th>Barang</th>
        <th>Jumlah</th>
        <th>Penerima</th>
        <th>Keterangan</th>
        <th>Tanggal Keluar</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let transaksi of transaksiList">
        <td>{{ transaksi.barang.nama }}</td>
        <td>{{ transaksi.jumlah }}</td>
        <td>{{ transaksi.penerima }}</td>
        <td>{{ transaksi.keterangan }}</td>
        <td>{{ transaksi.tanggalKeluar | date: 'dd/MM/yyyy' }}</td>
        <td>
          <button
            class="btn btn-danger"
            (click)="transaksi._id ? deleteBarangKeluar(transaksi._id) : null"
          >
            Hapus
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
